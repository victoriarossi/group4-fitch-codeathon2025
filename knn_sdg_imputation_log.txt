Loading data...

Dataset shape: (997, 24)
Missing sdg_id: 596 rows
Known sdg_id: 401 rows

SDG distribution in known data:
sdg_id
2.0      26
3.0     108
4.0      10
5.0       2
6.0       5
7.0      28
8.0       8
9.0      79
11.0     37
12.0     64
13.0     27
16.0      7
Name: count, dtype: int64

================================================================================
FEATURE PREPROCESSING
================================================================================

Features used: ['revenue_log', 'environmental_score', 'social_score', 'governance_score', 'target_scope_1', 'target_scope_2', 'env_score_adjustment_capped', 'region_code', 'activity_type', 'nace_level_1_code']
Total features: 10

================================================================================
MODEL VALIDATION
================================================================================

Testing different k values with 5-fold cross-validation:
------------------------------------------------------------
k= 5: 0.4438 (+/- 0.0465)
k=10: 0.4312 (+/- 0.0450)
k=15: 0.4188 (+/- 0.0441)
k=20: 0.4113 (+/- 0.0501)
k=25: 0.4163 (+/- 0.0474)

Best k value: 5 (accuracy: 0.4438)

================================================================================
TRAIN-TEST VALIDATION (80-20 split)
================================================================================

Test Set Accuracy: 0.4568

Classification Report:
              precision    recall  f1-score   support

         2.0       0.12      0.20      0.15         5
         3.0       0.71      0.77      0.74        22
         4.0       0.50      0.50      0.50         2
         6.0       0.00      0.00      0.00         1
         7.0       0.67      0.33      0.44         6
         8.0       0.00      0.00      0.00         2
         9.0       0.54      0.81      0.65        16
        11.0       0.00      0.00      0.00         8
        12.0       0.21      0.23      0.22        13
        13.0       0.00      0.00      0.00         5
        16.0       0.00      0.00      0.00         1

    accuracy                           0.46        81
   macro avg       0.25      0.26      0.25        81
weighted avg       0.40      0.46      0.42        81


Confusion matrix saved to: plots/sdg_confusion_matrix.png

================================================================================
PREDICTION CONFIDENCE ANALYSIS
================================================================================

Prediction Confidence Statistics:
Mean confidence: 0.7308
Median confidence: 0.6640
Min confidence: 0.3333
Max confidence: 1.0000

Mean confidence for correct predictions: 0.8431
Mean confidence for incorrect predictions: 0.6363

Confidence analysis saved to: plots/sdg_confidence_analysis.png

================================================================================
FINAL IMPUTATION
================================================================================

Imputed 596 missing sdg_id values

Predicted SDG distribution:
  SDG  2:  33 rows (5.5%)
  SDG  3: 276 rows (46.3%)
  SDG  4:   2 rows (0.3%)
  SDG  6:   1 rows (0.2%)
  SDG  7:  31 rows (5.2%)
  SDG  8:  42 rows (7.0%)
  SDG  9: 107 rows (18.0%)
  SDG 11:  31 rows (5.2%)
  SDG 12:  56 rows (9.4%)
  SDG 16:  17 rows (2.9%)

Imputation Confidence Statistics:
Mean confidence: 0.6170
Median confidence: 0.6000
Min confidence: 0.2010
Predictions with >70% confidence: 221 (37.1%)
Predictions with >50% confidence: 378 (63.4%)

Imputed dataset saved to: data/merged_dataset_imputed_sdg.csv
Imputation details saved to: data/sdg_imputation_details.csv

================================================================================
IMPUTATION QUALITY DIAGNOSTICS
================================================================================

✓ VALIDATION METRICS:
  - Cross-validation accuracy: 0.4438
  - Test set accuracy: 0.4568
  - Optimal k value: 5

✓ CONFIDENCE METRICS:
  - Mean imputation confidence: 0.6170
  - High confidence (>70%): 221/596 (37.1%)

✓ DISTRIBUTION COMPARISON:
  SDG distributions (known vs imputed):
      Known %  Imputed %
2.0       6.5        5.5
3.0      26.9       46.3
4.0       2.5        0.3
5.0       0.5        0.0
6.0       1.2        0.2
7.0       7.0        5.2
8.0       2.0        7.0
9.0      19.7       18.0
11.0      9.2        5.2
12.0     16.0        9.4
13.0      6.7        0.0
16.0      1.7        2.9

✓ OUTPUT FILES:
  - data/merged_dataset_imputed_sdg.csv
  - data/sdg_imputation_details.csv
  - plots/sdg_confusion_matrix.png
  - plots/sdg_confidence_analysis.png

================================================================================
IMPUTATION COMPLETE!
================================================================================
